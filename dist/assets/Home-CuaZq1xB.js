import{r as y,A as T,_ as C,c as D,R as l,u as N,j as e,a as _,B as A,d as v,b as B,e as E,f as O,g as I,l as $,h as q,s as F,i as P,k as M,m as H}from"./index-DbhMvLFR.js";import{D as S,R as o,C as a,S as U,r as z,F as G,T as W}from"./Filter-D0HOPc22.js";import{s as X,C as J,D as K}from"./Home-BDiaTItm.js";import{E as Q}from"./index-B3RJRkxt.js";var V={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"};const Y=V;var Z=function(s,i){return y.createElement(T,C({},s,{ref:i,icon:Y}))},ee=y.forwardRef(Z);const b=ee;function te(t){const{title:s="DETAIL",item:i={},open:h,onClose:m}=t,[c,x]=l.useState({}),p=N(),[f,d]=y.useState(!1),[u,j]=X.useMessage();l.useEffect(()=>{i.id!=c.peer_id&&x({peer_id:i.id,reason:-1,phone:i.phone||"",ban:1})},[i]);const g=()=>e.jsxs(S,{className:"drawer2",title:"Chi Tiết",width:520,closable:!1,onClose:()=>{d(!1),t.closeDetailLinkAndAccount()},open:f,placement:"left",children:[e.jsx("h3",{className:"title",children:"Bí Danh"}),t.reportState.detailLink.map((n,r)=>e.jsxs(o,{className:"row link",children:[e.jsxs(a,{span:8,children:["Bí danh ",r+1," :"]})," ",e.jsxs(a,{span:12,children:["@",n.link]})]},r)),e.jsx("h3",{className:"title",children:"Tài khoản chung số điện thoại"}),t.reportState.detailAccount.map((n,r)=>e.jsxs("div",{className:"row account",children:[e.jsxs(o,{children:[e.jsx(a,{span:8,children:"Tên:"}),e.jsx(a,{span:12,children:`${n.first_name} ${n.last_name}`})]}),e.jsxs(o,{children:[e.jsx(a,{span:8,children:"Số điện thoại:"}),e.jsx(a,{span:12,children:n.phone})]}),e.jsxs(o,{children:[e.jsx(a,{span:8,children:"Số lần bị báo cáo:"}),e.jsx(a,{span:12,children:n.totalReport})]})]},r))]}),R=n=>{x(r=>({...r,reason:n}))};return e.jsxs("div",{children:[j,e.jsxs(S,{className:"drawer1",title:"Thông tin người bị báo cáo",width:520,closable:!1,onClose:m,open:h,placement:"left",children:[e.jsxs(o,{className:"row",children:[e.jsx(a,{span:12,children:"Tên đầy đủ người bị báo cáo:"}),e.jsx(a,{span:8,children:i.name})]}),e.jsxs(o,{className:"row",children:[e.jsx(a,{span:12,children:"Số điện thoại:"}),e.jsx(a,{span:8,children:i.phone}),e.jsxs(a,{span:4,children:[" ",e.jsx(J,{className:"copy-icon",onClick:()=>{p.clipboard.writeText(i.phone).then(()=>{u.open({type:"success",content:"copy successfully"})})}})]})]}),e.jsxs(o,{className:"row",children:[e.jsx(a,{span:12,children:"Số bí danh của người bị báo cáo:"}),e.jsx(a,{span:8,children:i.total_Link})]}),e.jsxs(o,{className:"row",children:[e.jsx(a,{span:12,children:"Số tài khoản cùng số điện thoại:"}),e.jsx(a,{span:8,children:i.total_Account})]}),e.jsx(o,{children:e.jsxs(a,{className:"detail",onClick:()=>{t.detailLink({id:i.peer_id}),t.detailAccount({phone:i.phone}),d(!0)},children:[" ","xem chi tiết bí danh và tài khoản cùng số điện thoại"," ",e.jsx(b,{style:{marginLeft:10}})]})}),e.jsx(o,{className:"row",children:e.jsxs(a,{className:"detail",onClick:()=>{m(),p(`/report/user/${i.peer_id}`)},children:[" ","xem chi tiết danh sách thông tin báo cáo với tài khoản"," ",e.jsx(b,{style:{marginLeft:10}})]})}),g(),e.jsx(K,{}),e.jsxs(o,{children:[e.jsx("h3",{className:"title",children:"Chọn lí do cấm:"}),e.jsx(U,{style:{width:"90%"},placeholder:"Chọn lí do ban",onChange:R,options:z})]}),e.jsxs("div",{className:"note",children:["Warning: Lệnh ban được thực thi bởi"," ",_.get("account")||"admin hệ thống",", các tài khoản có cùng số điện thoại sẽ bị cấm , thông tin sẽ được xác thực bởi hệ thống"]}),e.jsx(A,{type:"primary",onClick:n=>{c.reason<0?(u.open({type:"error",content:"chọn lí do ban"}),n.preventDefault()):c.id==0?(u.open({type:"error",content:"user chưa xác định"}),n.preventDefault()):t.banUser(c)},children:"Thực hiện Ban"})]})]})}const ne=t=>({reportState:t.ReportReducer}),se=t=>({detailLink:s=>{t(v(s))},detailAccount:s=>{t(B(s))},closeDetailLinkAndAccount:()=>{t(E())},banUser:s=>{t(O(s))}}),L=D(ne,se)(te),ae=t=>{const[s,i]=l.useState(!1),h=I(),m=[{title:"Thứ Tự",width:100,dataIndex:"index",align:"center",key:"index"},{title:"Tên Người Bị Báo Cáo",dataIndex:"full_name",align:"center",key:"full_name"},{title:"Số Điện Thoại",dataIndex:"phone",align:"center",key:"phone"},{title:"Số Lượt Bị Báo Cáo",dataIndex:"total_reported",align:"center",key:"total_reported"},{title:"Thời Gian Báo Cáo",dataIndex:"created_at",align:"center",key:"created_at"},{title:"Xem Chi Tiết",align:"center",dataIndex:"action",key:"action",render:(n,r,w)=>e.jsx(o,{children:e.jsx(a,{span:5,offset:9,children:e.jsx(Q,{onClick:()=>{t.getDetail({id:r.id}),d(k=>({...k,id:r.peer_id})),i(!0)},style:{color:"#2196f3",cursor:"pointer",fontSize:20}})})},w)}],c=()=>{i(!s)},x=()=>{d({}),i(!1),t.closeForm()};l.useEffect(()=>{if(h.search){const n=new URLSearchParams(h.search),r=n.get("page"),w=n.get("limit"),k=n.get("sort");t.getReport({page:r,limit:w,orderBy:k})}else t.getReport({page:1,limit:20,orderBy:"DESC"})},[h.search]);const p=l.useMemo(()=>t.store.data.map((n,r)=>({...n,index:(t.store.page-1)*t.store.limit+r+1,full_name:`${n.firstName} ${n.last_name}`,phone:n.phone?n.phone:"_"})),[t.store.data,t.store.limit,t.store.page]),[f,d]=l.useState({});l.useEffect(()=>{Object.keys(t.store.detail).length!==0&&d(n=>({...n,...t.store.detail}))},[t.store]);const u=n=>{t.searchReport({page:1,limit:20,keySearch:n})},j=()=>{t.getReport({page:1,limit:20,orderBy:"DESC"})},g=n=>{t.filterByReason(n)},R=n=>{t.getReport({...n,page:1,limit:20})};return e.jsxs("div",{children:[e.jsx(G,{onSearch:u,reloadData:j,isSearch:!0,isNew:!0,isReason:!0,onSelect:g,onFilterTime:R}),e.jsx(L,{open:s,onOpen:c,onClose:x,item:f,title:"DETAIL REPORT INFORMATION"}),e.jsx(W,{columns:m,pageSize:t.store.limit,totalPage:t.store.totalPage,data:p})]})},ie=t=>({store:t.ReportReducer}),re=t=>({getReport:s=>{t($(s))},filterByReason:s=>{t(q(s))},searchReport:s=>{t(F(s))},getDetail:s=>{t(P(s))},deleteReport:s=>{t(M(s))},closeForm:()=>{t(H())}}),oe=D(ie,re)(ae);function ue(){return e.jsxs("div",{className:"wrap-home",children:[e.jsx(L,{}),e.jsx(oe,{})]})}export{ue as default};
